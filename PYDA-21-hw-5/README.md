# Домашнее задание

<a id='contents'></a>
## Оглавление:
### [Задание 1](#task1)
  * [Пункт 1:](#point1) пользователь по команде “p” может узнать владельца документа по его номеру
  * [Пункт 2:](#point2) пользователь по команде “p” может узнать владельца документа по его номеру
  * [Пункт 3:](#point3) пользователь по команде “l” может увидеть полную информацию по всем документам
  * [Пункт 4:](#point4) пользователь по команде “as” может добавить новую полку
  * [Пункт 5:](#point5) пользователь по команде “ds” может удалить существующую полку из данных (только если она пустая)
  * [Пункт 6:](#point6) основное тело программы
  
### [Задание 1](#task1)
  * [Пункт 1:](#point7) пользователь по команде “ad” может добавить новый документ в данные
  * [Пункт 2:](#point8) пользователь по команде “d” может удалить документ из данных
  * [Пункт 3:](#point9) пользователь по команде “m” может переместить документ с полки на полку

Вам нужно помочь секретарю автоматизировать работу. Для этого нужно написать программу, которая будет на основе хранимых данных исполнять пользовательские команды.

Исходные данные имеют следующую структуру:

1. перечень всех документов


```python
documents = [
{'type': 'passport', 'number': '2207 876234', 'name': 'Василий Гупкин'},
{'type': 'invoice', 'number': '11-2', 'name': 'Геннадий Покемонов'},
{'type': 'insurance', 'number': '10006', 'name': 'Аристарх Павлов'}
]
```

2. перечень полок, на которых хранятся документы (если документ есть в documents, то он обязательно должен быть и в directories)


```python
directories = {
'1': ['2207 876234', '11-2'],
'2': ['10006'],
'3': []
}
```

Общие требования к программе:
- код должен быть грамотно декомпозирован (каждая функция отвечает за свою конкретную задачу, дублирующийся функционал переиспользуется, а его код не повторяется);
- в коде отсутствуют глобальные переменные (за исключением documents и directories);
- пользовательский ввод обрабатывается в цикле while до тех пор, пока пользователь явно не завершит программу (вводом команды “q”).

<a id='task1'></a>
## Задание 1

<a id='point1'></a>
### Пункт 1
Пользователь по команде “p” может узнать владельца документа по его номеру


```python
def doc_owner(in_value = None):
    '''
    Функция запрашивает номер документа и выводит владельца документа.
    '''
    # проверяем, если в фунцию не передана переменная (т.е. значение осталось пустым), тогда in_value
    # будет в функции if возвращать false, в этом случае мы это проверяем и просим внести значение.
    # сделано это для того, чтобы в функцию можно было и передать значение и ввести его принудительно (для функции doc_info)
    if not(in_value):
        in_value = input('\nВведите номер документа: ')
    for doc in documents:
        if in_value in doc.values():
            return f"владелец: {doc.get('name')}"
    # в случае, если ни один if не выполнился, т.е. документ не найден
    # и return не прервал функцию - выводим сообщение об ошибке
    return 'Документ не найден в базе.'
```


```python
print(doc_owner())
```

    
    Введите номер документа: 10006
    владелец: Аристарх Павлов
    

[к оглавлению](#contents)

<a id='point2'></a>
### Пункт 2
Пользователь по команде “s” может по номеру документа узнать на какой полке он хранится


```python
def shelf_search(in_value = None):
    '''
    Функция запрашивает номер документа и выводит полку, на которой он размещен.
    '''
    # проверяем, если в фунцию не передана переменная (т.е. значение осталось пустым), тогда in_value
    # будет в функции if возвращать false, в этом случае мы это проверяем и просим внести значение.
    # сделано это для того, чтобы в функцию можно было и передать значение и ввести его принудительно (для функции doc_info)
    if not(in_value):
        in_value = input('\nВведите номер документа: ')
    for shelf, docs in directories.items():
        if docs.count(in_value):
            return f"полка хранения: {shelf}"
    # в случае, если ни один if не выполнился, т.е. документ не найден
    # и return не прервал функцию - выводим сообщение об ошибке
    return 'Документ не найден в базе.'
```


```python
print(shelf_search())
```

    
    Введите номер документа: 10006
    полка хранения: 2
    

[к оглавлению](#contents)

<a id='point3'></a>
### Пункт 3
Пользователь по команде “l” может увидеть полную информацию по всем документам


```python
def doc_info():
    '''
    Функция выводит полную информацию по всем документам.
    '''
    out_info = []
    
    for doc in documents:
        out_info.append(f"№: {doc.get('number')}, тип: {doc.get('type')}, {doc_owner(doc.get('number'))}, {shelf_search(doc.get('number'))}")
    # т.к. \n нельзя использовать внутри {}, можно перевод строки сделать или chr(10) или '\n' присвоить переменной и ее
    # использовать: nl = '\n', {nl.join(out_info)}
    return f"Текущий список документов:\n{chr(10).join(out_info)}"
```


```python
print(doc_info())
```

    Текущий список документов:
    №: 2207 876234, тип: passport, владелец: Василий Гупкин, полка хранения: 1
    №: 11-2, тип: invoice, владелец: Геннадий Покемонов, полка хранения: 1
    №: 10006, тип: insurance, владелец: Аристарх Павлов, полка хранения: 2
    

[к оглавлению](#contents)

<a id='point4'></a>
### Пункт 4
Пользователь по команде “as” может добавить новую полку


```python
def shelf_add(in_value = None):
    '''
    Функция запрашивает номер полки, проверяет ее наличие.
    Если полка существует - сообщает это и выводит перечень всех номеров полок.
    Если полка с таким номером отсутствуе - создает новую полку в словаре с ключем = введенному номеру, 
    значение - пустой список.
    '''
    if not(in_value):
        in_value = input('Введите номер полки: ')
    if in_value in directories:
        return f"Такая полка уже существует. Текущий перечень полок: {', '.join(list(directories))}"
    else:
        directories.update({in_value:[]}) 
        return f"Полка добавлена. Текущий перечень полок: {', '.join(list(directories))}"
```


```python
print(shelf_add())
```

    Введите номер полки: 10
    Полка добавлена. Текущий перечень полок: 1, 2, 3, 10
    

[к оглавлению](#contents)

<a id='point5'></a>
### Пункт 5.
Пользователь по команде “ds” может удалить существующую полку из данных (только если она пустая)


```python
def shelf_del(in_value = None):
    '''
    Функция запрашивает номер полки, проверяет ее наличие и наполнение.
    Если полка существует и пустая - удаляе. Если полка с таким номером существует, но не пустая - сообщает об этом.
    Если отсутствует - сообщает об этом.
    '''
    if not(in_value):
        in_value = input('Введите номер полки: ')
    if in_value not in directories:
        return f"Такой полки не существует. Текущий перечень полок: {', '.join(list(directories))}"
    else:
        # проверяем, если значение выбранной пользователем полки пустое, т.е. под not() примет значение true,
        # полку удаляем; если не пустое - просим сначала удалить документы
        if directories.get(in_value):
            return f"На полке есть документы, удалите их перед удалением полки. Текущий перечень полок: {', '.join(list(directories))}"
        else:
            directories.pop(in_value)
            return f"Полка удалена. Текущий перечень полок: {', '.join(list(directories))}"
```


```python
print(shelf_del())
```

    Введите номер полки: 10
    Полка удалена. Текущий перечень полок: 1, 2, 3
    

[к оглавлению](#contents)

<a id='point6'></a>
### Пункт 6.
Основное тело программы


```python
def start_func(in_command):
    '''
    Функция - обработчик подфункций через создание их словаря и вызов по комманде, являющейся ключем:
    q - выход из программы,
    p - поиск владельца по номеру документа,
    s - поиск места хранения документа по его номеру,
    l - полный каталог всех документов с информацией по ним,
    as - добавление полки для хранения документов,
    ds - удаление пустой полки для хранения документов,
    ad - добавление документа,
    d - удаление документа из базы,
    m - перемещение документа между полками
    '''
    return {'q':'q',
            'p':doc_owner,
            's':shelf_search,
            'l':doc_info,
            'as':shelf_add,
            'ds':shelf_del,
            'ad':doc_add,
            'd':doc_del,
            'm':doc_move
           }.get(in_command, 'Неверная комманда')
```

[к оглавлению](#contents)


```python
# задаем тело основной программы
import keyboard  # включаем модуль keyboard

print('Программа запущена')
in_key = input('\nВведите комманду: ')
while in_key != 'q':
    print(start_func(in_key)())
    in_key = input('\nВведите комманду: ')
print('\nПрограмма завершена')
```

    Программа запущена
    
    Введите комманду: p
    
    Введите номер документа: 12345
    Документ не найден в базе.
    
    Введите комманду: s
    
    Введите номер документа: 12345
    Документ не найден в базе.
    
    Введите комманду: l
    
    Полная информация по всем документам:
    №: 2207 876234, тип: passport, владелец: Василий Гупкин, полка хранения: 1
    №: 11-2, тип: invoice, владелец: Геннадий Покемонов, полка хранения: 1
    №: 10006, тип: insurance, владелец: Аристарх Павлов, полка хранения: 2
    
    Введите комманду: as
    Введите номер полки: 1
    Такая полка уже существует. Текущий перечень полок: 1, 2, 3
    
    Введите комманду: ds
    Введите номер полки: 4
    Такой полки не существует. Текущий перечень полок: 1, 2, 3
    
    Введите комманду: ds
    Введите номер полки: 1
    На полке есть документы, удалите их перед удалением полки. Текущий перечень полок: 1, 2, 3
    
    Введите комманду: q
    
    Программа завершена
    

<a id='task2'></a>
## Задание 2
Вам необходимо дополнить программу из задания 1 более продвинутыми командами.

<a id='point7'></a>
### Пункт 1
Пользователь по команде “ad” может добавить новый документ в данные


```python
def doc_add():
    doc_dict = {}
    
    '''
    Функция добавляет информацию по документу, при этом проверяя существование полки
    '''
    doc_dict.update({'number':input('Введите номер документа: ')})
    doc_dict.update({'type':input('Введите тип документа: ')})
    doc_dict.update({'name':input('Введите владельца документа: ')})
    shelf_num = input('Введите полку для хранения: ')
    if shelf_num in directories:
        documents.append(doc_dict)
        directories[shelf_num].append(doc_dict['number'])
        return f"Документ добавлен.\n{doc_info()}"
    else:
        return f"Такой полки не существует. Добавьте полку командой as.\n{doc_info()}"
```

[к оглавлению](#contents)


```python
print(doc_add())
```

    Введите номер документа: 42
    Введите тип документа: multipassport
    Введите владельца документа: R2D2
    Введите полку для хранения: 4
    Такой полки не существует. Добавьте полку командой as.
    Текущий список документов:
    №: 2207 876234, тип: passport, владелец: Василий Гупкин, полка хранения: 1
    №: 11-2, тип: invoice, владелец: Геннадий Покемонов, полка хранения: 1
    №: 10006, тип: insurance, владелец: Аристарх Павлов, полка хранения: 2
    


```python
print(doc_add())
print('\n', directories)
```

    Введите номер документа: 42
    Введите тип документа: multipassport
    Введите владельца документа: R2D2
    Введите полку для хранения: 3
    Документ добавлен.
    Текущий список документов:
    №: 2207 876234, тип: passport, владелец: Василий Гупкин, полка хранения: 1
    №: 11-2, тип: invoice, владелец: Геннадий Покемонов, полка хранения: 1
    №: 10006, тип: insurance, владелец: Аристарх Павлов, полка хранения: 2
    №: 42, тип: multipassport, владелец: R2D2, полка хранения: 3
    
     {'1': ['2207 876234', '11-2'], '2': ['10006'], '3': ['42']}
    

<a id='point8'></a>
### Пункт 2
Пользователь по команде “d” может удалить документ из данных


```python
def doc_del(doc_num = None):
    '''
    Функция удаляет информацию по документу, при этом проверяя существование документа
    '''
    # создаем копию списка инфо по документам, чтобы совершать над ним действия,
    # не приводя к ошибкам из-за изменения записей в списке
    documents_copy = documents.copy()
    
    if not(doc_num):
        doc_num = input('Введите номер документа: ')
    for doc in documents_copy:
        if doc_num in doc.values():
            documents.remove(doc)
            shelf_num = shelf_search(doc_num).replace('полка хранения: ', '')
            directories[shelf_num].remove(doc_num)
#            directories.update({shelf_num:directories[shelf_num].remove(doc_num)})
            return f"Документ удален.\n{doc_info()}" 
    # в случае, если ни один if не выполнился, т.е. документ не найден
    # и return не прервал функцию - выводим сообщение об ошибке
    return f"Документ не найден в базе.\n{doc_info()}"       
```

[к оглавлению](#contents)


```python
print(doc_del())
```

    Введите номер документа: 123456
    
    Текущий список документов:
    Документ не найден в базе.
    №: 2207 876234, тип: passport, владелец: Василий Гупкин, полка хранения: 1
    №: 11-2, тип: invoice, владелец: Геннадий Покемонов, полка хранения: 1
    №: 10006, тип: insurance, владелец: Аристарх Павлов, полка хранения: 2
    


```python
print(doc_del())
print('\n', directories)
```

    Введите номер документа: 42
    Документ удален.
    Текущий список документов:
    №: 2207 876234, тип: passport, владелец: Василий Гупкин, полка хранения: 1
    №: 11-2, тип: invoice, владелец: Геннадий Покемонов, полка хранения: 1
    №: 10006, тип: insurance, владелец: Аристарх Павлов, полка хранения: 2
    
     {'1': ['2207 876234', '11-2'], '2': ['10006'], '3': []}
    

<a id='point9'></a>
### Пункт 3
Пользователь по команде “m” может переместить документ с полки на полку


```python
def doc_move():
    '''
    Функция перемещает документ с полки на полку
    '''
    in_doc = input('Введите номер документа: ')
    in_shelf = input('Введите номер полки: ')
    if doc_owner(in_doc) == 'Документ не найден в базе.':
        return doc_del(in_doc)
    elif in_shelf not in directories:
        return shelf_del(in_shelf)
    directories[shelf_search(in_doc).replace('полка хранения: ', '')].remove(in_doc)
    directories[in_shelf].append(in_doc)
    return f"Документ перемещен.\n{doc_info()}"
```

[к оглавлению](#contents)


```python
print(doc_move())
```

    Введите номер документа: 11-2
    Введите номер полки: 10
    Такой полки не существует. Текущий перечень полок: 1, 2, 3
    


```python
print(doc_move())
```

    Введите номер документа: 42
    Введите номер полки: 2
    Документ не найден в базе.
    Текущий список документов:
    №: 2207 876234, тип: passport, владелец: Василий Гупкин, полка хранения: 1
    №: 11-2, тип: invoice, владелец: Геннадий Покемонов, полка хранения: 1
    №: 10006, тип: insurance, владелец: Аристарх Павлов, полка хранения: 2
    


```python
print(directories,'\n')
print(doc_move(),'\n')
print(directories)
```

    {'1': ['2207 876234', '11-2'], '2': ['10006'], '3': []} 
    
    Введите номер документа: 11-2
    Введите номер полки: 3
    Документ перемещен.
    Текущий список документов:
    №: 2207 876234, тип: passport, владелец: Василий Гупкин, полка хранения: 1
    №: 11-2, тип: invoice, владелец: Геннадий Покемонов, полка хранения: 3
    №: 10006, тип: insurance, владелец: Аристарх Павлов, полка хранения: 2 
    
    {'1': ['2207 876234'], '2': ['10006'], '3': ['11-2']}
    
